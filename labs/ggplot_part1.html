<!DOCTYPE html>
<html>
<head>
  <title>ggplot2: The Grammar of Graphics</title>

  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />



  <meta name="date" content="2016-09-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="stylesheet" media="all" href="lib/ioslides-13.5.1/fonts/fonts.css">

  <link rel="stylesheet" media="all" href="lib/ioslides-13.5.1/theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="lib/ioslides-13.5.1/theme/css/phone.css">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'ggplot2: The Grammar of Graphics',
                        useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                      },

      // Author information
      presenters: [
            {
        name:  'William Hopper' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }

  </style>

  <link rel="stylesheet" href="../theme/css/custom.css" type="text/css" />

</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">2016-09-18</p>
          </hgroup>
  </slide>

<slide class=''><hgroup><h2>The Grammar of Graphics</h2></hgroup><article  id="the-grammar-of-graphics">

<p>The <code>ggplot2</code> package provides a library of plotting and graphics tools that implements the <a href='http://www.springer.com/us/book/9780387245447' title=''>&quot;Grammar of Graphics&quot;</a> (Wilkison, 2005; Wilkinson, Anand, &amp; Grossman, 2005).</p>

<p>Wilkinson&#39;s &quot;Grammar of Graphics&quot; is both a technical description of the structures used to produce quantitative visualizations, as well as a new language to describe the visual features of quantitative visualizations. In many ways, it formalizes what you intuitively know about plots and graphs already, but had no &quot;lemma&quot; for.</p>

<p>Realizing that <code>ggplot2</code> implements a new &quot;grammar&quot; than you&#39;ve used previously helps facilitate adopting a different mindset than you&#39;ve used previously, which in turn helps produce more effective visualizations, more quickly.</p>

</article></slide><slide class=''><hgroup><h2>The Grammar of Graphics</h2></hgroup><article  id="the-grammar-of-graphics-1">

<p>The <code>ggplot</code> system of plotting distinguishes between three main sets of features that all visualizations posses.</p>

<ul>
<li>Aesthetics

<ul>
<li>The &quot;low level&quot; features of the data shown in a plot</li>
</ul></li>
<li>Geoms

<ul>
<li>The geometric objects used to instantiate the data visually</li>
</ul></li>
<li>Scales

<ul>
<li>The aspects of a plot that allow you to measure the aesthetics</li>
</ul></li>
</ul>

</article></slide><slide class=''><hgroup><h2>Aesthetics</h2></hgroup><article  id="aesthetics">

<p>Aesthetics are the &quot;simple&quot; features possessed by data when they are displayed visually</p>

<ul>
<li>The color of a datum is one of its aesthetics</li>
<li>The x position of a datum is one of its aesthetics</li>
<li>The y position of a datum is one of its aesthetics</li>
<li>The size of a datum is one of its aesthetics</li>
<li>The shape of a datum is one of its aesthetics</li>
</ul>

<p>In any visualization, aesthetics may or may not be used to carry information</p>

<ul>
<li>E.g., the color of each datum may be the same, or colors may differ in order to convey that there are different groups of data.</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Geoms</h2></hgroup><article  id="geoms">

<p>Geoms are the geometric objects chosen to instantiate the data visually, like points, lines, bars, or text.</p>

<p>Choosing the right geom can bring clarity to your visualization</p>

<ul>
<li>The same observations could be visualized with circles, or lines, or rectangular bars, or with all 3!</li>
</ul>

<p>Importantly, different geoms have different aesthetics</p>

<ul>
<li>A bar can&#39;t have a shape aesthetic (it&#39;s already a rectangle), but it can take on different border colors, different fill colors, and different positions</li>
<li>A line can&#39;t have a shape aesthetic (it&#39;s a line) or a fill aesthetic (it&#39;s 1D, you can&#39;t fill it), but it can have different types (dotted, dashed, etc) and line colors.</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Scales</h2></hgroup><article  id="scales">

<p>Scales are the features of a plot that allow you to measure the aesthetics (i.e., map them back from colors and shapes to the variable and values of the dataset)</p>

<ul>
<li>The ticks and labels on the x axis might allow you to match axis position with a specific timepoint</li>
<li>The colors and labels in a legend allow you to match colors to a specific group</li>
</ul>

<p>Importantly, the general term &quot;scales&quot; is chosen over the more common term &quot;legend&quot; because these features of the plot are used to measure and map many different aesthetics, discrete or continuous.</p>

</article></slide><slide class=''><hgroup><h2>ggplot is data-driven plotting</h2></hgroup><article  id="ggplot-is-data-driven-plotting">

<p>The ggplot tool set is specifically oriented around creating a plot from your <em>dataset</em>, rather than from individual vectors.</p>

<p>In my view, this is the better conceptual model to have: all plots begin with data, and data are never a set of values without a context.</p>

<p>This is the main reason we choose data frames as the structure to hold our data in R. Data frames allows us to efficiently organize our data by the unique observations we&#39;ve made, and each variable we&#39;ve made observations of.</p>

<p>So the main aim of the <code>ggplot</code> tool set is to take the relational structure you&#39;ve already defined in your data frame and translate it into a visualization via <em>aesthetic mappings</em>.</p>

</article></slide><slide class=''><hgroup><h2>Mapping variables to aesthetics</h2></hgroup><article  id="mapping-variables-to-aesthetics">

<p>Making a plot with <code>ggplot2</code> always begins with a call to the <code>ggplot</code> function, which takes 2 arguments:</p>

<ul>
<li><code>data</code>: The name of the data frame which holds the information you&#39;d like to plot</li>
<li><code>mapping:</code> The list of aesthetic mappings to use for the plot</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Mapping variables to aesthetics</h2></hgroup><article  id="mapping-variables-to-aesthetics-1">

<p>The <code>mapping</code> argument requires a special list of values created by the function <code>aes</code>. The <code>aes</code> function constructs this list when you provide it special key/value pairs</p>

<ul>
<li>The &quot;keys&quot; are unquoted names of plot aesthetics (<code>x</code>, <code>y</code>, <code>color</code>, <code>shape</code>, <code>linetype</code>, etc.)</li>
<li>The &quot;values&quot; are unquoted names of variables (i.e., column names) in your data frame</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Getting Started</h2></hgroup><article  id="getting-started">

<p>It&#39;s time to start getting into some code! For our examples, we&#39;ll use the built-in <code>Orange</code> dataset, which contains measurements of trunk circumference (measured in mm.) over time (measured in days) from 5 orange trees.</p>

<table class = 'rmdtable'>
<col width="9%" />
<col width="8%" />
<col width="20%" />
<tr class="header">
<th align="center">Tree</th>
<th align="center">age</th>
<th align="center">circumference</th>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">118</td>
<td align="center">30</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">484</td>
<td align="center">58</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">664</td>
<td align="center">87</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">1004</td>
<td align="center">115</td>
</tr>
<tr class="odd">
<td align="center">&#8230;</td>
<td align="center">&#8230;</td>
<td align="center">&#8230;</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">118</td>
<td align="center">33</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">484</td>
<td align="center">69</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">664</td>
<td align="center">111</td>
</tr>
<tr class="odd">
<td align="center">&#8230;</td>
<td align="center">&#8230;</td>
<td align="center">&#8230;</td>
</tr>
</table>

</article></slide><slide class=''><hgroup><h2>A First Plot</h2></hgroup><article  id="a-first-plot">

<p>Lets think about how best to visualize these circumferences.</p>

<p>These measurements are taken over time, and it&#39;s usually best to represent time on the x-axis, so we&#39;ll map the <code>age</code> variable to the <code>x</code> aesthetic.</p>

<p>The dependent measure should almost always be represented along the y-axis, so we&#39;ll map the <code>circumference</code> variable to the <code>x</code> aesthetic.</p>

<p>There are measurements from 5 different trees, so we ought to represent the different trees visually in some way. Many possibilities exist, but let&#39;s try representing each tree with a different color, by mapping the <code>Tree</code> variable to the <code>color</code> aesthetic.</p>

<pre class = 'prettyprint lang-r'>library(ggplot2)
ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree))</pre>

</article></slide><slide class=''><hgroup><h2>A First (Blank) Plot</h2></hgroup><article  id="a-first-blank-plot">

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree))</pre>

<p><img src="ggplot_part1_files/figure-html/frist_two-1.png" width="576" style="display: block; margin: auto;" /></p>

<p>Where&#39;s the <del>beef</del> data? Our plot is blank because we didn&#39;t add any geometric objects to represent the data!</p>

</article></slide><slide class=''><hgroup><h2>Adding layers to the plot</h2></hgroup><article  id="adding-layers-to-the-plot">

<p>To add a geom object to represent the data, we need to add a new &quot;layer&quot; containing those geom objects to the plot.</p>

<p>We do this, we need two things: we need a function to create the geometric object layer, and function to add it to the plot.</p>

<p>As pointed out earlier, ggplot supports creating many different geometric objects, and there is a different function to create the layer for each one.</p>

<p>The names of the these functions follow a common pattern: <code>geom_</code>, followed by the name of the geometric object.</p>

<ul>
<li><code>geom_point</code>, <code>geom_line</code>, <code>geom_bar</code>, <code>geom_boxplot</code>, etc.</li>
</ul>

</article></slide><slide class=''><hgroup><h2>Adding layers to the plot</h2></hgroup><article  id="adding-layers-to-the-plot-1">

<p>Lets use points to instantiate our data on the plot, via the <code>geom_points()</code> function, and then add the layer of points to our blank plot with the <code>+</code> operator.</p>

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree)) + 
  geom_point()</pre>

<p><img src="ggplot_part1_files/figure-html/points-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Scales are free!</h2></hgroup><article  id="scales-are-free">

<p>Because we mapped the <code>Tree</code> variable to the <code>color</code> aesthetic, we get a different color point for each tree. Additionally, a legend is automatically drawn.</p>

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree)) + 
  geom_point()</pre>

<p><img src="ggplot_part1_files/figure-html/unnamed-chunk-1-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>ggplots are first-class</h2></hgroup><article  id="ggplots-are-first-class">

<p>Note that we do <em>not</em> necessarily have to create the entire plot at once. ggplots can be saved as R objects, instead of being drawn in the plot window, simply by using the assignment operator.</p>

<pre class = 'prettyprint lang-r'>plot_obj &lt;- ggplot(data = Orange,
               mapping = aes(x = age, y = circumference, color = Tree))
plot_obj + geom_point() # now we see our plot</pre>

<p><img src="ggplot_part1_files/figure-html/firstclass-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Changing geoms</h2></hgroup><article  id="changing-geoms">

<p>Let&#39;s also connect the points for each tree, using <code>geom_line</code>, so a viewer can easily chart the course of a single tree&#39;s growth.</p>

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree)) + 
  geom_point() + 
  geom_line()</pre>

<p><img src="ggplot_part1_files/figure-html/lines-1.png" width="576" style="display: block; margin: auto;" /> Notice how the color scale automatically shows both lines and points now!</p>

</article></slide><slide class=''><hgroup><h2>Adjusting the scale</h2></hgroup><article  id="adjusting-the-scale">

<p>One annoyance is that the scale seems to sorts the trees in random order. As it turns out, there is a method to this madness.</p>

<p>The <code>Tree</code> variable is an ordered factor, and the factor levels are arranged in that specific order.</p>

<pre class = 'prettyprint lang-r'>str(Orange$Tree)</pre>

<pre >##  Ord.factor w/ 5 levels &quot;3&quot;&lt;&quot;1&quot;&lt;&quot;5&quot;&lt;&quot;2&quot;&lt;..: 2 2 2 2 2 2 2 4 4 4 ...</pre>

<p>As mentioned previously, <code>ggplot</code> is oriented around the characteristics of your data set, and if a variable is an ordered factor, then ggplot respects that ordering when it creates its scales.</p>

</article></slide><slide class=''><hgroup><h2>Adjusting the scale</h2></hgroup><article  id="adjusting-the-scale-1">

<p>Lets change the variable to be a regular, un-ordered factor. We can use R functions on variables inside <code>aes</code> just as if they were normal objects.</p>

<p>Here, <code>factor</code> just changes the ordering of the factor levels, without relabeling the data from each tree.</p>

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference,
                     color = factor(Tree, levels = 1:5))) + 
  geom_point() +  geom_line()</pre>

<p><img src="ggplot_part1_files/figure-html/unordered-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Adjusting the scale</h2></hgroup><article  id="adjusting-the-scale-2">

<p>However, we need not modify the dataset itself to achieve the desired result: we can manipulate the scale itself with some functions provided by <code>ggplot</code>.</p>

<p>The functions for manipulating the scales have a consistent naming scheme: <code>scale_</code>, followed by the name of the aesthetic they are measuring, followed by the type of variable the aesthetic represents (e.g,. continuous, discrete, etc.)</p>

<p>Here, we&#39;ll use the <code>scale_color_discrete</code> function to modify our scale, because we&#39;ve mapped each tree to a distinct color.</p>

</article></slide><slide class=''><hgroup><h2>Adjusting the scale</h2></hgroup><article  id="adjusting-the-scale-3">

<p>The <code>limits</code> argument sets the range of the scale, as well as the default order of the displayed labels.</p>

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree)) + 
  geom_point() +geom_line() + 
  scale_color_discrete(limits = as.character(1:5))</pre>

<p><img src="ggplot_part1_files/figure-html/unordered_easy-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Adjusting the scale</h2></hgroup><article  id="adjusting-the-scale-4">

<p>We could use the <code>limits</code> argument to only display a color scale for <em>some</em> of the trees. I don&#39;t know why you&#39;d want to, but this just gives you an idea of how you can restrict your scales with the <code>limits</code> argument more generally.</p>

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree)) + 
  geom_point() +geom_line() + 
  scale_color_discrete(limits = as.character(2:3))</pre>

<p><img src="ggplot_part1_files/figure-html/unordered_subset-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Adjusting the colors</h2></hgroup><article  id="adjusting-the-colors">

<p>You can exactly specify which colors to use using their color names (see <code>?colors</code>) or Hexadecimal RRB values and <code>scale_color_manual</code>.</p>

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree)) + 
  geom_point() + geom_line() + 
  scale_color_manual(values = c(&quot;black&quot;,&quot;cornflowerblue&quot;, &quot;brown1&quot;,
                                &quot;darkgreen&quot;, &quot;deeppink&quot;),
                     limits = as.character(1:5))</pre>

<p><img src="ggplot_part1_files/figure-html/manual-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Adjusting the colors</h2></hgroup><article  id="adjusting-the-colors-1">

<p>If you have the <code>RColorBrewer</code> package, you can use the color palettes it provides via the <code>scale_color_brewer()</code> function.</p>

<pre class = 'prettyprint lang-r'>RColorBrewer::display.brewer.all()</pre>

<p><img src="ggplot_part1_files/figure-html/palletes-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Adjusting the colors</h2></hgroup><article  id="adjusting-the-colors-2">

<p>Let&#39;s use the <code>&quot;Set1&quot;</code> pallete for our colors by specifying the <code>palette</code> argument to <code>scale_color_brewer</code></p>

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree)) + 
  geom_point() + geom_line() + 
  scale_color_brewer(palette = &quot;Set1&quot;, limits = as.character(1:5))</pre>

<p><img src="ggplot_part1_files/figure-html/set1-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Adjusting the colors</h2></hgroup><article  id="adjusting-the-colors-3" class="img-centered">

<p>There are many custom-made pallets to choose from, if you&#39;re willing to go looking for them. For example, one of my favorite sets of palletes are the <a href='https://github.com/karthik/wesanderson' title=''>Wes Anderson Color Palletes</a>, which I encourage you to check out.</p>

<p><img src='../images/rushmore.jpg' title=''/><br/></p>

</article></slide><slide class=''><hgroup><h2>Setting an aesthetic</h2></hgroup><article  id="setting-an-aesthetic">

<p>We can also set the aesthetics for our data to a constant property (i.e., <em>not</em> have the aesthetic change across levels of a variable).</p>

<p>For example, we can change what type of line is drawn by setting the <code>linetype</code> aesthetic to constant value <em>outside</em> the <code>aes</code> function and inside the <code>geom_line()</code> funtion.</p>

<pre class = 'prettyprint lang-r'>ggplot(data = Orange,
       mapping = aes(x = age, y = circumference, color = Tree)) + 
  geom_point() + geom_line(linetype = &quot;longdash&quot;) + 
  scale_color_brewer(palette = &quot;Set1&quot;, limits = as.character(1:5))</pre>

<p><img src="ggplot_part1_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;" /></p>

</article></slide><slide class=''><hgroup><h2>Activity</h2></hgroup><article  id="activity">

<p>The <code>Indometh</code> dataset has pharmacokinetics measurements (i.e., excretion/absorbtion of a drug) of the NSAID pain-killer <em>indometacin</em>.</p>

<p>6 subjects were administered a dose of <em>indometacin</em>, and their blood concentration levels were measured 11 times afterwards (see <code>?Indometh</code> for more info).</p>

<p>Use <code>ggplot</code> to visualize the data collected from each subject. Be sure to</p>

<ol>
<li>Distininguish between the data from each subject</li>
<li>Arrange the scale identifying the data from each subject in ascending order.</li>
<li>Experiment with using points, lines, points and lines, with different sizes of each, to see which looks best.</li>
</ol></article></slide>


  <slide class="backdrop"></slide>

</slides>

<script src="lib/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
<script src="lib/ioslides-13.5.1/js/prettify/prettify.js"></script>
<script src="lib/ioslides-13.5.1/js/prettify/lang-r.js"></script>
<script src="lib/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
<script src="lib/ioslides-13.5.1/js/hammer.js"></script>
<script src="lib/ioslides-13.5.1/js/slide-controller.js"></script>
<script src="lib/ioslides-13.5.1/js/slide-deck.js"></script>


<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
